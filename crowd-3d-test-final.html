<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Beux Design - Award Winning UX</title>
  <link rel="stylesheet" href="https://use.typekit.net/wya6atu.css">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow-x: hidden;
      background: #000;
      cursor: none;
    }

    /* Custom Cursor */
    .custom-cursor {
      position: fixed;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(208, 255, 113, 0.6);
      border-radius: 50%;
      pointer-events: none;
      z-index: 10000;
      transition: transform 0.15s ease, opacity 0.3s ease;
      mix-blend-mode: difference;
    }

    .custom-cursor.hover {
      transform: scale(2);
      background: rgba(208, 255, 113, 0.1);
    }

    @media (pointer: coarse) {
      .custom-cursor { display: none; }
      body { cursor: auto; }
    }

    .hero-sticky-container {
      position: relative;
      min-height: 100vh;
    }

    #hero-section {
      position: relative;
      width: 100%;
      min-height: 100vh;
      background: transparent;
      overflow: visible;
      padding-bottom: 200px;
    }

    @media (max-width: 768px) {
      #hero-section {
        background: linear-gradient(180deg, #0c4a6e 0%, #082f49 100%);
        padding-bottom: 100px;
      }
    }

    /* Enhanced gradient with more movement */
    #canvas-container {
      position: fixed;
      top: 150px;
      left: 0;
      width: 100%;
      height: 100vh;
      opacity: 0.9;
      z-index: 5;
      pointer-events: none;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      filter: saturate(1.2) contrast(1.1);
    }

    @media (max-width: 768px) {
      #canvas-container {
        top: 80px;
        opacity: 0.7;
        z-index: 1; /* Behind content on mobile */
      }
    }

    #canvas-container canvas {
      pointer-events: auto;
    }

    /* Orbs with stronger movement */
    .gradient-orb-1 {
      position: fixed;
      width: 1200px;
      height: 1200px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(34, 211, 238, 0.8) 0%, transparent 60%);
      filter: blur(140px);
      top: -35%;
      left: 50%;
      transform: translateX(-50%);
      animation: float1 15s ease-in-out infinite;
      z-index: 2;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    .gradient-orb-2 {
      position: fixed;
      width: 900px;
      height: 900px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(6, 182, 212, 0.7) 0%, transparent 65%);
      filter: blur(120px);
      bottom: -15%;
      right: 10%;
      animation: float2 12s ease-in-out infinite;
      z-index: 2;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    .gradient-orb-3 {
      position: fixed;
      width: 800px;
      height: 800px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(14, 165, 233, 0.6) 0%, transparent 70%);
      filter: blur(100px);
      top: 25%;
      left: 5%;
      animation: float3 18s ease-in-out infinite;
      z-index: 2;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    .gradient-orb-4 {
      position: fixed;
      width: 1400px;
      height: 1400px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(8, 47, 73, 0.9) 0%, transparent 60%);
      filter: blur(180px);
      bottom: -25%;
      left: 15%;
      animation: float4 22s ease-in-out infinite;
      z-index: 1;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    @keyframes float1 {
      0%, 100% {
        transform: translateX(-50%) translateY(0) scale(1) rotate(0deg);
        opacity: 0.8;
      }
      33% {
        transform: translateX(-45%) translateY(-100px) scale(1.3) rotate(5deg);
        opacity: 0.95;
      }
      66% {
        transform: translateX(-55%) translateY(80px) scale(0.85) rotate(-5deg);
        opacity: 0.7;
      }
    }

    @keyframes float2 {
      0%, 100% {
        transform: translate(0, 0) scale(1) rotate(0deg);
        opacity: 0.7;
      }
      33% {
        transform: translate(-110px, 80px) scale(1.35) rotate(8deg);
        opacity: 0.85;
      }
      66% {
        transform: translate(90px, -90px) scale(0.8) rotate(-8deg);
        opacity: 0.6;
      }
    }

    @keyframes float3 {
      0%, 100% {
        transform: translate(0, 0) scale(1) rotate(0deg);
        opacity: 0.6;
      }
      50% {
        transform: translate(-120px, 100px) scale(1.4) rotate(10deg);
        opacity: 0.75;
      }
    }

    @keyframes float4 {
      0%, 100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.9;
      }
      50% {
        transform: translate(80px, -60px) scale(1.2);
        opacity: 1;
      }
    }

    .fixed-gradient-bg {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 100% 80% at 50% 0%, #22d3ee 0%, transparent 60%),
        radial-gradient(ellipse 80% 60% at 80% 30%, #06b6d4 0%, transparent 50%),
        radial-gradient(ellipse 70% 60% at 20% 40%, #0ea5e9 0%, transparent 50%),
        radial-gradient(ellipse 120% 100% at 50% 100%, #0c4a6e 0%, transparent 60%),
        radial-gradient(ellipse 150% 120% at 30% 80%, #082f49 0%, transparent 70%),
        radial-gradient(ellipse 100% 100% at 70% 70%, #0a3a5c 0%, transparent 65%),
        linear-gradient(180deg, #0c4a6e 0%, #082f49 40%, #051e34 100%);
      opacity: 1;
      animation: breathe 5s ease-in-out infinite, gradientPulse 10s ease-in-out infinite;
      z-index: 1;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    @media (max-width: 768px) {
      .fixed-gradient-bg {
        display: none; /* Hide gradient on mobile */
      }
      
      .gradient-orb-1,
      .gradient-orb-2,
      .gradient-orb-3,
      .gradient-orb-4 {
        display: none; /* Hide orbs on mobile */
      }
      
      .noise-overlay {
        display: none; /* Hide noise on mobile */
      }
      
      .vignette {
        display: none; /* Hide vignette on mobile */
      }
      
      /* Add simple mobile background */
      body {
        background: linear-gradient(180deg, #0c4a6e 0%, #082f49 50%, #051e34 100%);
      }
    }

    @keyframes breathe {
      0%, 100% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.2);
        opacity: 0.8;
      }
    }

    @keyframes gradientPulse {
      0%, 100% {
        filter: brightness(1) contrast(1);
      }
      50% {
        filter: brightness(1.15) contrast(1.1);
      }
    }

    @font-face {
      font-family: 'Aloe';
      src: url('assets/fonts/AloeveraDisplay-Bold.woff2') format('woff2'),
           url('assets/fonts/AloeveraDisplay-Bold.woff') format('woff');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    .noise-overlay {
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.025;
      mix-blend-mode: overlay;
      pointer-events: none;
      z-index: 3;
      animation: noiseShift 8s steps(10) infinite;
    }

    @keyframes noiseShift {
      0%, 100% { transform: translate(0, 0); }
      10% { transform: translate(-5%, -5%); }
      20% { transform: translate(-10%, 5%); }
      30% { transform: translate(5%, -10%); }
      40% { transform: translate(-5%, 10%); }
      50% { transform: translate(10%, 5%); }
      60% { transform: translate(5%, -5%); }
      70% { transform: translate(-10%, -10%); }
      80% { transform: translate(10%, 10%); }
      90% { transform: translate(-5%, 5%); }
    }

    .vignette {
      position: fixed;
      inset: 0;
      background: radial-gradient(ellipse at center, transparent 30%, rgba(5, 30, 52, 0.6) 100%);
      pointer-events: none;
      z-index: 4;
    }

    #hero-content {
      position: relative;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      min-height: 100vh;
      padding: 0 60px;
      max-width: 1400px;
      margin: 0 auto;
      color: white;
      top: 150px;
    }

    @media (max-width: 768px) {
      #hero-content {
        padding: 0 20px;
        top: 80px;
      }
    }

    h1 {
      font-size: clamp(2.5rem, 5vw, 7.5rem);
      font-weight: 300;
      line-height: 1.1;
      margin-bottom: 0px;
      letter-spacing: -0.02em;
      filter: blur(25px);
      opacity: 0;
      transform: translateY(30px);
      transition: filter 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1),
                  transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    h1.revealed {
      filter: blur(0px);
      opacity: 1;
      transform: translateY(0);
    }

    nav {
      position: absolute;
      top: 40px;
      right: 60px;
      z-index: 20;
      display: flex;
      gap: 40px;
    }

    @media (max-width: 768px) {
      nav {
        top: 20px;
        right: 20px;
        gap: 20px;
      }
    }

    nav a {
      color: white;
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 400;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    nav a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background: #D0FF71;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    nav a:hover {
      color: #D0FF71;
      transform: translateY(-2px);
    }

    nav a:hover::after {
      width: 100%;
    }

    @media (max-width: 768px) {
      nav a {
        font-size: 0.85rem;
      }
    }

    .logo {
      position: absolute;
      top: 40px;
      left: 60px;
      z-index: 20;
      color: white;
      font-size: 1.5rem;
      font-weight: 400;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .logo:hover {
      transform: scale(1.05);
    }

    @media (max-width: 768px) {
      .logo {
        top: 20px;
        left: 20px;
        font-size: 1.2rem;
      }
    }

    .logo-be {
      font-weight: 400;
      font-family: 'Aloe';
    }

    .logo-design {
      font-style: italic;
      font-weight: 300;
      font-family: "dm-serif-display", sans-serif;
    }

    .title-prefix {
      font-family: 'Aloe';
      font-weight: 400;
      font-size: clamp(2.5rem, 5vw, 7.5rem);
      color: white;
    }

    .highlight-human,
    .highlight-curious,
    .highlight-design {
      color: white;
      font-style: italic;
      font-family: "dm-serif-display", sans-serif;
      font-weight: 400;
      font-style: italic;
      margin-right: 20px;
    }

    .tagline-grid {
      display: grid;
      gap: 40px;
      width: 100%;
      margin-bottom: 60px;
    }

    .tagline {
      font-size: clamp(1rem, 1.5vw, 1.8vw);
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.9);
      font-weight: 300;
      filter: blur(15px);
      opacity: 0;
      transform: translateY(30px);
      transition: filter 1.8s cubic-bezier(0.4, 0, 0.2, 1), 
                  opacity 1.8s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 1.8s cubic-bezier(0.4, 0, 0.2, 1);
      transition-delay: 0.5s;
    }

    .tagline.revealed {
      filter: blur(0px);
      opacity: 0.1;
      transform: translateY(0);
      font-family: 'Aloe';
      width: 40%;
    }

    @media (max-width: 768px) {
      .tagline.revealed {
        width: 100%;
      }
    }

    .green {
      color: #D0FF71;
      text-shadow: 0 0 20px rgba(208, 255, 113, 0.3);
    }

    #loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 1.2rem;
      z-index: 25;
    }

    .spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top: 3px solid #D0FF71;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* White section with subtle gradient */
    .white-section {
      position: relative;
      min-height: 100vh;
      background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%);
      padding: 120px 60px;
      z-index: 30;
    }

    @media (max-width: 768px) {
      .white-section {
        padding: 80px 20px;
      }
    }

    .white-section-content {
      max-width: 1400px;
      margin: 0 auto;
    }

    .white-section h2 {
      font-size: clamp(2.5rem, 6vw, 5rem);
      font-weight: 300;
      line-height: 1.2;
      margin-bottom: 40px;
      color: #0a4d5c;
      filter: blur(20px);
      opacity: 0;
      transform: translateY(40px);
      transition: filter 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .white-section h2.revealed {
      filter: blur(0px);
      opacity: 1;
      transform: translateY(0);
    }

    .white-section p {
      font-size: clamp(1rem, 1.25rem, 1.25rem);
      line-height: 1.8;
      color: #555;
      max-width: 800px;
      filter: blur(15px);
      opacity: 0;
      transform: translateY(30px);
      transition: filter 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .white-section p:nth-of-type(1) { transition-delay: 0.2s; }
    .white-section p:nth-of-type(2) { transition-delay: 0.4s; }

    .white-section p.revealed {
      filter: blur(0px);
      opacity: 1;
      transform: translateY(0);
    }

    .gradient-return-section {
      position: relative;
      min-height: 150vh;
      background: white;
      z-index: 30;
    }

    .expanding-gradient-bg {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%) translateY(50%);
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: #0a4d5c;
      z-index: 1;
      transition: width 0.05s linear, height 0.05s linear;
      box-shadow: 0 0 100px 50px rgba(10, 77, 92, 0.3);
    }

    .expanding-gradient-bg::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background:
        radial-gradient(circle at center, #14b8a6 0%, #06b6d4 30%, #0891b2 50%, #134e4a 80%, #0a4d5c 100%);
      opacity: 1;
    }

    .gradient-return-content {
      position: relative;
      z-index: 2;
      padding: 120px 60px;
      max-width: 1400px;
      margin: 0 auto;
      color: white;
    }

    @media (max-width: 768px) {
      .gradient-return-content {
        padding: 80px 20px;
      }
    }

    .gradient-return-content h2 {
      font-size: clamp(2.5rem, 6vw, 5rem);
      font-weight: 300;
      line-height: 1.2;
      margin-bottom: 40px;
      filter: blur(20px);
      opacity: 0;
      transform: translateY(40px);
      transition: filter 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .gradient-return-content.visible h2 {
      filter: blur(0px);
      opacity: 1;
      transform: translateY(0);
    }

    .gradient-return-content p {
      font-size: clamp(1rem, 1.25rem, 1.25rem);
      line-height: 1.8;
      max-width: 800px;
      filter: blur(15px);
      opacity: 0;
      transform: translateY(30px);
      transition: filter 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
      transition-delay: 0.3s;
    }

    .gradient-return-content.visible p {
      filter: blur(0px);
      opacity: 1;
      transform: translateY(0);
    }

    /* Smooth scroll - optimized for mobile */
    html, body { height: 100%; }

    body {
      overflow-x: hidden;
      overflow-y: auto;
      overscroll-behavior: none;
      -webkit-overflow-scrolling: touch;
    }

    #smooth-wrapper {
      position: fixed;
      inset: 0;
      overflow: hidden;
      width: 100%;
      height: 100%;
      will-change: transform;
      z-index: 10;
    }

    #smooth-content {
      position: relative;
      width: 100%;
      will-change: transform;
      transform: translate3d(0, 0, 0);
    }

    /* Disable smooth scroll on mobile for better performance */
    @media (pointer: coarse) {
      #smooth-wrapper {
        position: static;
      }
      #smooth-content {
        transform: none !important;
      }
      body {
        height: auto !important;
      }
      
      /* Disable all animations on mobile */
      *,
      *::before,
      *::after {
        animation: none !important;
        transition-duration: 0.3s !important;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      #smooth-wrapper {
        position: static;
        transform: none !important;
      }
      #smooth-content {
        transform: none !important;
      }
      body { height: auto !important; }
    }
  </style>
</head>

<body>
  <!-- Custom Cursor -->
  <div class="custom-cursor"></div>

  <!-- FIXED BACKGROUNDS -->
  <div class="fixed-gradient-bg"></div>
  <div class="gradient-orb-1"></div>
  <div class="gradient-orb-2"></div>
  <div class="gradient-orb-3"></div>
  <div class="gradient-orb-4"></div>
  <div class="noise-overlay"></div>
  <div class="vignette"></div>
  <div id="canvas-container"></div>

  <!-- SCROLLING CONTENT -->
  <div id="smooth-wrapper">
    <div id="smooth-content">

      <div class="hero-sticky-container">
        <section id="hero-section">

          <div class="logo">
            <span class="logo-be">Beux<span class="green">.</span></span><span class="logo-design">Design</span>
          </div>

          <nav>
            <a href="#home">Home</a>
            <a href="#about">About</a>
            <a href="#work">Work</a>
            <a href="#contact">Contact</a>
          </nav>

          <div id="loading">
            <div class="spinner"></div>
            <p>Loading experience...</p>
          </div>

          <div id="hero-content">
            <h1>
              <span class="title-prefix">Be<span class="green">.</span></span><span class="highlight-human">inspired</span><br>
              <span class="title-prefix">Be<span class="green">.</span></span><span class="highlight-curious">immersed</span><br>
              <span class="title-prefix">Be<span class="green">.</span></span><span class="highlight-design">intentional</span>
            </h1>

            <div class="tagline-grid">
              <p class="tagline">
               Great design guides users naturally, shaping behaviour, driving outcomes, creating impact.
              </p>
            </div>
          </div>
        </section>
      </div>

      <section class="white-section">
        <div class="white-section-content">
          <h2>Our Approach</h2>
          <p>
            We believe design is more than aestheticsâ€”it's about understanding human behavior, anticipating needs, and
            creating experiences that feel intuitive and meaningful. Every project begins with empathy and ends with impact.
          </p>
          <br><br>
          <p>
            Through careful research, thoughtful iteration, and close collaboration, we craft digital experiences that not
            only meet business goals but also resonate deeply with the people who use them.
          </p>
        </div>
      </section>

      <section class="gradient-return-section">
        <div class="expanding-gradient-bg"></div>
        <div class="gradient-return-content">
          <h2>Ready to create something meaningful?</h2>
          <p>
            Let's explore how thoughtful design can transform your product and connect with your audience in ways that matter.
          </p>
        </div>
      </section>

    </div>
  </div>

  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
      }
    }
  </script>

  <script type="module">
    import * as THREE from 'three';
    import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
    import { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';

    // Custom Cursor
    const cursor = document.querySelector('.custom-cursor');
    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

    if (!isTouchDevice && cursor) {
      let mouseX = 0, mouseY = 0;
      let cursorX = 0, cursorY = 0;

      document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
      });

      function animateCursor() {
        cursorX += (mouseX - cursorX) * 0.15;
        cursorY += (mouseY - cursorY) * 0.15;
        cursor.style.left = cursorX + 'px';
        cursor.style.top = cursorY + 'px';
        requestAnimationFrame(animateCursor);
      }
      animateCursor();

      document.querySelectorAll('a, button').forEach(el => {
        el.addEventListener('mouseenter', () => cursor.classList.add('hover'));
        el.addEventListener('mouseleave', () => cursor.classList.remove('hover'));
      });
    }

    // Smooth scroll - disabled on mobile
    const smoothWrapper = document.getElementById('smooth-wrapper');
    const smoothContent = document.getElementById('smooth-content');
    const isMobile = window.matchMedia('(pointer: coarse)').matches;

    let currentY = 0;
    let targetY = 0;
    let maxScroll = 0;
    const ease = 0.085;
    const minDelta = 0.1;

    function setBodyHeight() {
      if (isMobile || window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        document.body.style.height = 'auto';
        if (smoothWrapper) smoothWrapper.style.position = 'static';
        return;
      }

      const contentHeight = smoothContent.getBoundingClientRect().height;
      document.body.style.height = `${contentHeight}px`;
      maxScroll = Math.max(0, contentHeight - window.innerHeight);
    }

    function smoothTick() {
      if (isMobile || window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      targetY = Math.min(window.scrollY, maxScroll);
      currentY += (targetY - currentY) * ease;

      if (Math.abs(targetY - currentY) < minDelta) {
        currentY = targetY;
      }

      smoothContent.style.transform = `translate3d(0, ${-currentY}px, 0)`;
      requestAnimationFrame(smoothTick);
    }

    function refreshSmoothScroll() {
      setBodyHeight();
    }

    if (!isMobile) {
      window.addEventListener('resize', setBodyHeight, { passive: true });
      window.addEventListener('load', () => {
        setBodyHeight();
        requestAnimationFrame(smoothTick);
      });
    }

    // Three.js Scene
    const scene = new THREE.Scene();
    scene.background = null;

    const camera = new THREE.PerspectiveCamera(
      50,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.set(0, 1, 12);
    camera.lookAt(0, 1, 0);

    const renderer = new THREE.WebGLRenderer({
      antialias: !isMobile,
      alpha: true,
      powerPreference: isMobile ? 'low-power' : 'high-performance'
    });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, isMobile ? 1.5 : 2));
    renderer.shadowMap.enabled = !isMobile;
    document.getElementById('canvas-container').appendChild(renderer.domElement);

    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(5, 10, 7.5);
    directionalLight.castShadow = !isMobile;
    scene.add(directionalLight);

    const rimLight = new THREE.DirectionalLight(0x7a9fc4, 0.4);
    rimLight.position.set(-5, 3, -5);
    scene.add(rimLight);

    const loader = new GLTFLoader();
    const dracoLoader = new DRACOLoader();
    dracoLoader.setDecoderPath('https://www.gstatic.com/draco/versioned/decoders/1.5.6/');
    loader.setDRACOLoader(dracoLoader);

    let mixer;
    let crowd;

    loader.load(
      'final-crows-test.glb',
      (gltf) => {
        crowd = gltf.scene;
        crowd.scale.set(isMobile ? 2.5 : 3.5, isMobile ? 2.5 : 3.5, isMobile ? 2.5 : 3.5);

        const box = new THREE.Box3().setFromObject(crowd);
        const center = box.getCenter(new THREE.Vector3());
        crowd.position.sub(center);
        crowd.position.y = 0;

        // Fix orientation - rotate 180 degrees so crowd faces camera
        crowd.rotation.y = Math.PI;

        scene.add(crowd);

        if (gltf.animations && gltf.animations.length > 0) {
          mixer = new THREE.AnimationMixer(crowd);
          gltf.animations.forEach((clip) => {
            const action = mixer.clipAction(clip);
            action.play();
          });
        }

        document.getElementById('loading').style.display = 'none';
        if (!isMobile) refreshSmoothScroll();
      },
      undefined,
      (error) => {
        console.error('Error loading model:', error);
        document.getElementById('loading').innerHTML = '<p>Error loading 3D model</p>';
      }
    );

    const clock = new THREE.Clock();
    let targetPosition = new THREE.Vector3(0, 0, 0);
    let mouseX = 0;
    let mouseY = 0;

    function animate() {
      requestAnimationFrame(animate);

      const delta = clock.getDelta();
      if (mixer) mixer.update(delta);

      if (crowd && !isMobile) {
        crowd.position.x += (targetPosition.x - crowd.position.x) * 0.05;

        const targetTiltX = -mouseY * 0.25;
        crowd.rotation.x += (targetTiltX - crowd.rotation.x) * 0.05;

        const dx = targetPosition.x - crowd.position.x;

        if (Math.abs(dx) > 0.01) {
          const targetRotation = Math.atan2(dx, 1) + Math.PI;
          let rotDiff = targetRotation - crowd.rotation.y;
          while (rotDiff > Math.PI) rotDiff -= Math.PI * 2;
          while (rotDiff < -Math.PI) rotDiff += Math.PI * 2;
          crowd.rotation.y += rotDiff * 0.1;
        }
      }

      renderer.render(scene, camera);
    }

    animate();

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, isMobile ? 1.5 : 2));
      if (!isMobile) refreshSmoothScroll();
    });

    if (!isMobile) {
      document.addEventListener('mousemove', (event) => {
        mouseX = (event.clientX / window.innerWidth) * 2 - 1;
        mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
        targetPosition.x = mouseX * 5;
      });
    }

    // Scroll effects
    const expandingGradient = document.querySelector('.expanding-gradient-bg');
    const gradientReturnSection = document.querySelector('.gradient-return-section');
    const gradientReturnContent = document.querySelector('.gradient-return-content');
    const whiteSection = document.querySelector('.white-section');

    const heroTitle = document.querySelector('h1');
    const taglines = document.querySelectorAll('.tagline');
    const whiteSectionH2 = document.querySelector('.white-section h2');
    const whiteSectionPs = document.querySelectorAll('.white-section p');

    const fixedGradientBg = document.querySelector('.fixed-gradient-bg');
    const orbs = [
      document.querySelector('.gradient-orb-1'),
      document.querySelector('.gradient-orb-2'),
      document.querySelector('.gradient-orb-3'),
      document.querySelector('.gradient-orb-4')
    ];
    const noise = document.querySelector('.noise-overlay');
    const vignette = document.querySelector('.vignette');
    const canvasContainer = document.getElementById('canvas-container');

    function handleScrollEffects() {
      const scrollY = window.scrollY;
      const viewportHeight = window.innerHeight;

      const heroSection = document.getElementById('hero-section');
      if (heroSection) {
        const heroBottom = heroSection.offsetTop + heroSection.offsetHeight;
        const fadeStart = heroBottom - viewportHeight;
        const fadeEnd = heroBottom;

        if (scrollY > fadeStart) {
          const fadeProgress = Math.min((scrollY - fadeStart) / (fadeEnd - fadeStart), 1);
          const opacity = 1 - fadeProgress;

          if (fixedGradientBg) fixedGradientBg.style.opacity = opacity;
          orbs.forEach(orb => { if (orb) orb.style.opacity = opacity; });
          if (noise) noise.style.opacity = opacity * 0.025;
          if (vignette) vignette.style.opacity = opacity;
          if (canvasContainer) canvasContainer.style.opacity = opacity * 0.9;
        } else {
          if (fixedGradientBg) fixedGradientBg.style.opacity = '1';
          orbs.forEach(orb => { if (orb) orb.style.opacity = ''; });
          if (noise) noise.style.opacity = '';
          if (vignette) vignette.style.opacity = '';
          if (canvasContainer) canvasContainer.style.opacity = isMobile ? '0.7' : '0.9';
        }

        // MOBILE: Hide canvas completely when scrolling
        if (isMobile && canvasContainer) {
          if (scrollY > 100) {
            canvasContainer.style.display = 'none';
          } else {
            canvasContainer.style.display = 'block';
          }
        }
      }

      if (heroTitle) heroTitle.classList.add('revealed');
      if (taglines) taglines.forEach(tag => tag.classList.add('revealed'));

      if (whiteSection) {
        const whiteSectionTop = whiteSection.offsetTop;
        const scrollPosition = scrollY + viewportHeight * 0.6;

        if (scrollPosition > whiteSectionTop) {
          if (whiteSectionH2) whiteSectionH2.classList.add('revealed');
          if (whiteSectionPs) whiteSectionPs.forEach(p => p.classList.add('revealed'));
        }
      }

      if (gradientReturnSection && expandingGradient) {
        const gradientSectionTop = gradientReturnSection.offsetTop;
        const gradientSectionHeight = gradientReturnSection.offsetHeight;
        const viewportScroll = scrollY + viewportHeight;

        if (viewportScroll > gradientSectionTop) {
          const progress = Math.min((viewportScroll - gradientSectionTop) / gradientSectionHeight, 1);

          const maxSize = Math.sqrt(window.innerWidth ** 2 + window.innerHeight ** 2) * 2.5;
          const size = 100 + (progress * maxSize);

          expandingGradient.style.width = `${size}px`;
          expandingGradient.style.height = `${size}px`;

          if (progress > 0.3) {
            if (gradientReturnContent) gradientReturnContent.classList.add('visible');
          }
        }
      }
    }

    window.addEventListener('scroll', handleScrollEffects, { passive: true });
    
    setTimeout(() => {
      handleScrollEffects();
      if (!isMobile) refreshSmoothScroll();
    }, 100);
  </script>
</body>
</html>
